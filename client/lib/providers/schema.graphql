# GraphQL schema example
#
# https://gqlgen.com/getting-started/

# go: go run github.com/99designs/gqlgen generate

# GraphQL schema example
#
# https://gqlgen.com/getting-started/

# go: go run github.com/99designs/gqlgen generate

scalar DateTime

type RecordObject{
  data: String!
}

type RecordObject{
  data: String!
}

type Token {
  id: String!
  user: String!
  accessToken: String!
  refreshToken: String!
  accessTokenExpiry: DateTime!
  refreshTokenExpiry: DateTime!
  device: String!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type User{
  id: String!
  phoneNumber: String!
  password: String!
  name: String!
  createdAt: DateTime!
  updatedAt: DateTime!
  lastLogin: DateTime!
  status: Int!
  role: String!
}

type Medication{
  id: String!
  name: String!
  dosage: Float!
  unit: String!
  frequency: String!
  inventory: Float!
  userId: String!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type MedicationReminder{
  id: String!
  medicationId: String!
  userId: String!
  reminderTime: DateTime!
  isTaken: Boolean!
  createdAt: DateTime!
}

type MedicalRecord{
  id: String!
  userId: String!
  recordType: String!
  content: String!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type HealthMetric{
  id: String!
  userId: String!
  metricType: String!
  value: Float!
  unit: String!
  recordedAt: DateTime!
  createdAt: DateTime!
}

type TreatmentSchedule{
  id: String!
  treatmentType: String!
  scheduledTime: DateTime!
  location: String!
  notes: String
}

type FamilyMember{
  id: String!
  userId: String!
  relatedUserId: String!
  relationship: String!
  accessLevel: Int!
  createdAt: DateTime!
}

type AchievementBadge{
  id: String!
  name: String!
  description: String!
  iconUrl: String!
  createdAt: DateTime!
}

type UserAchievement{
  id: String!
  userId: String!
  badgeId: String!
  earnedAt: DateTime!
  createdAt: DateTime!
}

type PasswordChange {
  id: String!
  user: String!
  token: String!
  createdAt: DateTime!
}

type CreateUserResponse {
  userId: String!
  message: String!
}

type LoginUserResponse {
  userId: String!
  token: Token!
  message: String!
}

type UserDetailResponse {
  userId: String!
  phoneNumber: String!
  name: String!
  role: String!
  createdAt: DateTime!
  lastLogin: DateTime
}

type UpdateUserResponse {
  userId: String!
  message: String!
}

type DeleteUserResponse {
  message: String!
}

type RequestPasswordResetResponse {
  message: String!
}

type ResetPasswordResponse {
  message: String!
}

type AddMedicationResponse {
  medicationId: String!
  message: String!
}

type MedicationDetail {
  medicationId: String!
  name: String!
  dosage: Float!
  unit: String!
  frequency: String!
  inventory: Float!
}

type UpdateMedicationResponse {
  medicationId: String!
  message: String!
}

type DeleteMedicationResponse {
  message: String!
}

type CreateMedicationReminderResponse {
  reminderId: String!
  message: String!
}

type UpdateMedicationReminderResponse {
  reminderId: String!
  message: String!
}

type DeleteMedicationReminderResponse {
  message: String!
}

type MedicationReminderDetail {
  reminderId: String!
  medicationId: String!
  reminderTime: DateTime!
  isTaken: Boolean!
}

type CreateTreatmentScheduleResponse {
  scheduleId: String!
  message: String!
}

type TreatmentScheduleDetail {
  scheduleId: String!
  treatmentType: String!
  scheduledTime: DateTime!
  location: String!
  notes: String
}

type UpdateTreatmentScheduleResponse {
  scheduleId: String!
  message: String!
}

type DeleteTreatmentScheduleResponse {
  message: String!
}

type AddHealthMetricResponse {
  metricId: String!
  message: String!
}

type HealthMetricDetail {
  metricId: String!
  metricType: String!
  value: Float!
  unit: String!
  recordedAt: DateTime!
}

type UpdateHealthMetricResponse {
  metricId: String!
  message: String!
}

type DeleteHealthMetricResponse {
  message: String!
}

type FoodSpec{
  name: String!
  value: Float!
  unit: String!
  howHigh: Float!
}

type FoodSpecs{
  specs: [FoodSpec!]!
  howRecommend: Float!
}

type AddMedicalRecordResponse {
  recordId: String!
  message: String!
}

type MedicalRecordDetail {
  recordId: String!
  recordType: String!
  content: String!
  createdAt: DateTime!
}

type UpdateMedicalRecordResponse {
  recordId: String!
  message: String!
}

type DeleteMedicalRecordResponse {
  message: String!
}

type AddFamilyMemberResponse {
  memberId: String!
  message: String!
}

type FamilyMemberDetail {
  memberId: String!
  relatedUserId: String!
  relationship: String!
  accessLevel: Int!
}

type UpdateFamilyMemberResponse {
  memberId: String!
  message: String!
}

type DeleteFamilyMemberResponse {
  message: String!
}

type CreateAchievementBadgeResponse {
  badgeId: String!
  message: String!
}

type AchievementBadgeDetail {
  badgeId: String!
  name: String!
  description: String!
  iconUrl: String!
}

type AwardAchievementResponse {
  userAchievementId: String!
  message: String!
}

type UserAchievementDetail {
  userAchievementId: String!
  badgeId: String!
  earnedAt: DateTime!
}

type FoodRecommendation{
  name: String!
}

type ProfileDetail {
  id: String!
  name: String!
  phoneNumber: String!
  role: String!
  createdAt: DateTime!
}

type ShareProfileResponse {
  message: String!
}

type UnshareProfileResponse {
  message: String!
}

type Question{
  questionId: Int!
  question: String!
  questionType: Int! # ex. 0 = single choice, 1 = multiple choice, 2 = fill in the blank, etc.
  choices: [String!] # empty if it is fill in the blank
}

type QuestionnaireObject{
  questionnaireId: Int!
  data: [Question!]!
}

input Response{
  questionId: Int!
  choice: String!#数字序号用，隔开
  answer: String
}

type HealthResponse{
  questionId: Int!
  choice: String!#数字序号用，隔开
  answer: String
}

input FilledQuestionnaire{
  questionnaireId: Int!  # 第几套测试题
  responses: [Response!]!
}

type HealthRiskAssessment{
  id: String!
  user_id: String!
  questionnaire_data: [HealthResponse!]!
  risk_level: String!
  recommendations: String!
  created_at: DateTime!
}

type HealthRiskAssessmentDetailResponse {
  assessmentId: String!
  questionnaireData: [HealthResponse!]!
  riskLevel: String!
  recommendations: String!
  createdAt: DateTime!
}

type EvaluateHealthRiskAssessmentResponse {
  assessmentId: String!
  riskLevel: String!
  recommendations: String!
}

type TakeMedicationResponse{
  message: String!
}

type Query{
  # finish unwritten get functions
  getUser: UserDetailResponse
  getHealthRiskAssessment: [HealthRiskAssessmentDetailResponse] # 不做题目能拿到之前的结果
  getHealthRiskAssessmentQuestion: QuestionnaireObject #拿题目
  getMedications: [MedicationDetail]
  getMedicationReminders: [MedicationReminderDetail]
  getTreatmentSchedules: [TreatmentScheduleDetail]
  getHealthMetrics(startDate: DateTime, endDate: DateTime, metricType: String): [HealthMetricDetail]
  getMedicalRecords: [MedicalRecordDetail]
  getFamilyMembers: [FamilyMemberDetail]
  getAchievementBadges: [AchievementBadgeDetail]
  getUserAchievements: [UserAchievementDetail]

  # make mock endpoint: DONE
  getFoodSpecs(food: String!) : FoodSpecs
  getMockFoodSpecs(food: String!) : FoodSpecs
  getFoodRecommendation : FoodRecommendation
  getMockFoodRecommendation : FoodRecommendation
  getProfiles: [ProfileDetail]
  getSharedProfiles: [ProfileDetail]

  getSharedMedicalRecords(patientId: String!): [MedicalRecordDetail]
  getSharedTreatmentSchedule(patientId: String!): [TreatmentScheduleDetail]
  getSharedMedications(patientId: String!): [MedicationDetail]
  getSharedHealthMetrics(patientId: String!, startDate: DateTime, endDate: DateTime, metricType: String): [HealthMetricDetail]
}

type Mutation {
  # to do: DONE
  refreshToken(accessToken: String!, refreshToken: String!, device:String!): Token

  createUser(phoneNumber: String!, password: String!, username: String!, role: String!): CreateUserResponse
  loginUser(phoneNumber: String!, password: String!): LoginUserResponse
  updateUser(name: String, phoneNumber: String, password: String): UpdateUserResponse
  deleteUser: DeleteUserResponse
  requestPasswordReset(phoneNumber: String!): RequestPasswordResetResponse
  resetPassword(token: String!, newPassword: String!): ResetPasswordResponse
  
  createHealthRiskAssessment(questionnaireData: String!): HealthRiskAssessmentResponse  
  updateHealthRiskAssessment(assessmentId: String!, questionnaireData: String!): UpdateHealthRiskAssessmentResponse
  
  addMedication(name: String!, dosage: Float!, unit: String!, frequency: String!, inventory: Float!): AddMedicationResponse
  updateMedication(medicationId: String!, name: String, dosage: Float, unit: String, frequency: String, inventory: Float): UpdateMedicationResponse
  deleteMedication(medicationId: String!): DeleteMedicationResponse
  
  createMedicationReminder(medicationId: String!, reminderTime: DateTime!): CreateMedicationReminderResponse
  updateMedicationReminder(reminderId: String!, reminderTime: DateTime, isTaken: Boolean): UpdateMedicationReminderResponse
  deleteMedicationReminder(reminderId: String!): DeleteMedicationReminderResponse
  
  createTreatmentSchedule(treatmentType: String!, scheduledTime: DateTime!, location: String!, notes: String): CreateTreatmentScheduleResponse
  updateTreatmentSchedule(scheduleId: String!, treatmentType: String, scheduledTime: DateTime, location: String, notes: String): UpdateTreatmentScheduleResponse
  deleteTreatmentSchedule(scheduleId: String!): DeleteTreatmentScheduleResponse
  
  addHealthMetric(metricType: String!, value: Float!, unit: String!, recordedAt: String!): AddHealthMetricResponse 
  updateHealthMetric(metricId: String!, value: Float, unit: String): UpdateHealthMetricResponse
  deleteHealthMetric(metricId: String!): DeleteHealthMetricResponse
   
  addMedicalRecord(recordType: String!, content: String!): AddMedicalRecordResponse
  updateMedicalRecord(recordId: String!, recordType: String, content: String): UpdateMedicalRecordResponse
  deleteMedicalRecord(recordId: String!): DeleteMedicalRecordResponse
  
  # to do
  addFamilyMember(relatedUserId: String!, relationship: String!, accessLevel: String!): AddFamilyMemberResponse
  updateFamilyMember(memberId: String!, relationship: String, accessLevel: String): UpdateFamilyMemberResponse
  deleteFamilyMember(memberId: String!): DeleteFamilyMemberResponse

  createAchievementBadge(name: String!, description: String!, iconUrl: String!): CreateAchievementBadgeResponse
  awardAchievement(badgeId: String!): AwardAchievementResponse  

  shareProfile(phoneNumber: String!, accessLevel: String!, remarks: String!): ShareProfileResponse!
  unshareProfile(targetUserId: String!): UnshareProfileResponse!
  # to do: DONE
  refreshToken(accessToken: String!, refreshToken: String!, device:String!): Token

  createUser(phoneNumber: String!, password: String!, username: String!, role: String!): CreateUserResponse
  loginUser(phoneNumber: String!, password: String!): LoginUserResponse
  updateUser(name: String, phoneNumber: String, password: String): UpdateUserResponse
  deleteUser: DeleteUserResponse
  requestPasswordReset(phoneNumber: String!): RequestPasswordResetResponse
  resetPassword(token: String!, newPassword: String!): ResetPasswordResponse
  
  evaluateHealthRiskAssessment(filledQuestionnaire: FilledQuestionnaire!): EvaluateHealthRiskAssessmentResponse #拿结果
  
  addMedication(name: String!, dosage: Float!, unit: String!, frequency: String!, inventory: Float!): AddMedicationResponse
  updateMedication(medicationId: String!, name: String, dosage: Float, unit: String, frequency: String, inventory: Float): UpdateMedicationResponse
  deleteMedication(medicationId: String!): DeleteMedicationResponse

  createMedicationReminder(medicationId: String!, reminderTime: DateTime!): CreateMedicationReminderResponse
  updateMedicationReminder(reminderId: String!, reminderTime: DateTime, isTaken: Boolean): UpdateMedicationReminderResponse
  takeMedication(reminderId: String) : TakeMedicationResponse!
  deleteMedicationReminder(reminderId: String!) : DeleteMedicationReminderResponse
  
  createTreatmentSchedule(treatmentType: String!, scheduledTime: DateTime!, location: String!, notes: String): CreateTreatmentScheduleResponse
  updateTreatmentSchedule(scheduleId: String!, treatmentType: String, scheduledTime: DateTime, location: String, notes: String): UpdateTreatmentScheduleResponse
  deleteTreatmentSchedule(scheduleId: String!): DeleteTreatmentScheduleResponse
  
  addHealthMetric(metricType: String!, value: Float!, unit: String!, recordedAt: String!): AddHealthMetricResponse 
  updateHealthMetric(metricId: String!, value: Float, unit: String): UpdateHealthMetricResponse
  deleteHealthMetric(metricId: String!): DeleteHealthMetricResponse
   
  addMedicalRecord(recordType: String!, content: String!): AddMedicalRecordResponse
  updateMedicalRecord(recordId: String!, recordType: String, content: String): UpdateMedicalRecordResponse
  deleteMedicalRecord(recordId: String!): DeleteMedicalRecordResponse
  
  # to do
  addFamilyMember(relatedUserId: String!, relationship: String!, accessLevel: String!): AddFamilyMemberResponse
  updateFamilyMember(memberId: String!, relationship: String, accessLevel: String): UpdateFamilyMemberResponse
  deleteFamilyMember(memberId: String!): DeleteFamilyMemberResponse

  createAchievementBadge(name: String!, description: String!, iconUrl: String!): CreateAchievementBadgeResponse
  awardAchievement(badgeId: String!): AwardAchievementResponse  
}